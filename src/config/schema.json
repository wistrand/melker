{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Melker configuration schema",
  "properties": {
    "theme": {
      "type": "string",
      "default": "auto",
      "env": "MELKER_THEME",
      "flag": "--theme",
      "description": "Color theme"
    },
    "log.level": {
      "type": "string",
      "enum": ["TRACE", "DEBUG", "INFO", "WARN", "ERROR"],
      "default": "INFO",
      "env": "MELKER_LOG_LEVEL",
      "flag": "--log-level",
      "description": "Log verbosity"
    },
    "log.file": {
      "type": "string",
      "env": "MELKER_LOG_FILE",
      "flag": "--log-file",
      "description": "Log file path"
    },
    "log.bufferSize": {
      "type": "integer",
      "default": 500,
      "minimum": 10,
      "maximum": 10000,
      "env": "MELKER_LOG_BUFFER_SIZE",
      "description": "In-memory log buffer size for DevTools"
    },
    "ai.model": {
      "type": "string",
      "default": "openai/gpt-5.2-chat",
      "env": "MELKER_AI_MODEL",
      "description": "AI chat model"
    },
    "ai.audioModel": {
      "type": "string",
      "default": "openai/gpt-4o-audio-preview",
      "env": "MELKER_AUDIO_MODEL",
      "description": "Audio transcription model"
    },
    "ai.endpoint": {
      "type": "string",
      "default": "https://openrouter.ai/api/v1/chat/completions",
      "env": "MELKER_AI_ENDPOINT",
      "description": "AI API endpoint"
    },
    "ai.headers": {
      "type": "object",
      "env": "MELKER_AI_HEADERS",
      "envFormat": "name: value; name2: value2",
      "description": "Custom API headers"
    },
    "ai.siteName": {
      "type": "string",
      "env": "MELKER_AI_SITE_NAME",
      "description": "Site name for AI API"
    },
    "ai.siteUrl": {
      "type": "string",
      "env": "MELKER_AI_SITE_URL",
      "description": "Site URL for AI API"
    },
    "ai.audioGain": {
      "type": "number",
      "default": 2.0,
      "env": "MELKER_AUDIO_GAIN",
      "description": "Audio recording gain multiplier"
    },
    "dither.algorithm": {
      "type": "string",
      "enum": ["sierra-stable", "sierra", "floyd-steinberg", "ordered", "none"],
      "env": "MELKER_AUTO_DITHER",
      "description": "Dithering algorithm for images"
    },
    "dither.bits": {
      "type": "integer",
      "minimum": 1,
      "maximum": 8,
      "env": "MELKER_DITHER_BITS",
      "description": "Color depth for dithering"
    },
    "dither.blueNoisePath": {
      "type": "string",
      "env": "MELKER_BLUE_NOISE_PATH",
      "description": "Path to blue noise threshold matrix PNG (default: bundled media/blue-noise-64.png)"
    },
    "terminal.alternateScreen": {
      "type": "boolean",
      "default": true,
      "env": "MELKER_NO_ALTERNATE_SCREEN",
      "envInverted": true,
      "flag": "--no-alt-screen",
      "flagInverted": true,
      "description": "Use alternate screen buffer"
    },
    "terminal.syncRendering": {
      "type": "boolean",
      "default": true,
      "env": "MELKER_NO_SYNC",
      "envInverted": true,
      "description": "Synchronous rendering"
    },
    "terminal.forceFFmpeg": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_FFMPEG",
      "description": "Force FFmpeg instead of native audio on macOS"
    },
    "audio.muted": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_AUDIO_MUTED",
      "flag": "--muted",
      "description": "Mute all audio playback globally"
    },
    "render.gfxMode": {
      "type": "string",
      "enum": ["sextant", "block", "pattern", "luma", "sixel", "kitty", "iterm2", "hires", "isolines", "isolines-filled"],
      "default": "sextant",
      "env": "MELKER_GFX_MODE",
      "flag": "--gfx-mode",
      "description": "Graphics rendering: sextant (default), block (colored spaces), pattern (ASCII spatial), luma (ASCII brightness), sixel (true pixels), kitty (kitty protocol), iterm2 (iTerm2 protocol), hires (auto: kitty/sixel/iterm2/sextant), isolines (contour lines), isolines-filled (contour lines with fill)"
    },
    "render.isolineCount": {
      "type": "integer",
      "default": 2,
      "minimum": 1,
      "maximum": 20,
      "env": "MELKER_ISOLINE_COUNT",
      "description": "Number of auto-generated isolines for isolines gfx mode"
    },
    "render.isolineMode": {
      "type": "string",
      "enum": ["equal", "quantile", "nice"],
      "default": "quantile",
      "env": "MELKER_ISOLINE_MODE",
      "description": "Isoline distribution algorithm: equal (even spacing), quantile (data percentiles), nice (round numbers)"
    },
    "render.isolineSource": {
      "type": "string",
      "enum": ["luma", "red", "green", "blue", "alpha", "oklab", "oklch-hue"],
      "default": "oklab",
      "env": "MELKER_ISOLINE_SOURCE",
      "description": "Color channel for isoline scalar values: oklab (perceptual lightness), oklch-hue (color hue - groups reds, blues, etc.), luma (BT.601), or individual channels"
    },
    "headless.enabled": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_HEADLESS",
      "flag": "--headless",
      "description": "Run without terminal"
    },
    "headless.width": {
      "type": "integer",
      "default": 80,
      "env": "MELKER_HEADLESS_WIDTH",
      "description": "Virtual terminal width"
    },
    "headless.height": {
      "type": "integer",
      "default": 24,
      "env": "MELKER_HEADLESS_HEIGHT",
      "description": "Virtual terminal height"
    },
    "server.enabled": {
      "type": "boolean",
      "default": false,
      "flag": "--server",
      "env": "MELKER_SERVER",
      "description": "Enable the remote viewing server"
    },
    "server.port": {
      "type": "integer",
      "env": "MELKER_SERVER_PORT",
      "flag": "--server-port",
      "description": "WebSocket server port"
    },
    "server.host": {
      "type": "string",
      "default": "localhost",
      "env": "MELKER_SERVER_HOST",
      "description": "Server bind address"
    },
    "server.token": {
      "type": "string",
      "env": "MELKER_SERVER_TOKEN",
      "flag": "--server-token",
      "description": "Server connection token (auto-generated if not specified)"
    },
    "server.allowInput": {
      "type": "boolean",
      "default": false,
      "flag": "--server-allow-input",
      "env": "MELKER_ALLOW_SERVER_INPUT",
      "description": "Allow input from server clients"
    },
    "bundler.retainBundle": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_RETAIN_BUNDLE",
      "description": "Keep temp bundle files for debugging"
    },
    "performance.showStats": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_SHOW_STATS",
      "description": "Show performance stats overlay"
    },
    "markdown.debug": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_MARKDOWN_DEBUG",
      "description": "Debug markdown rendering"
    },
    "audio.debug": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_AUDIO_DEBUG",
      "description": "Replay recorded audio before transcription"
    },
    "persist": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_PERSIST",
      "flag": "--persist",
      "description": "Enable state persistence"
    },
    "lint": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_LINT",
      "flag": "--lint",
      "description": "Enable lint validation"
    },
    "script.consoleOverride": {
      "type": "boolean",
      "default": true,
      "env": "MELKER_NO_CONSOLE_OVERRIDE",
      "envInverted": true,
      "flag": "--no-console-override",
      "flagInverted": true,
      "description": "Disable console.log redirect to logger"
    },
    "oauth.clientId": {
      "type": "string",
      "default": "melker-client",
      "env": "MELKER_OAUTH_CLIENT_ID",
      "description": "OAuth client ID"
    },
    "oauth.port": {
      "type": "integer",
      "default": 1900,
      "env": "MELKER_OAUTH_PORT",
      "description": "OAuth callback server port"
    },
    "oauth.path": {
      "type": "string",
      "default": "/melker/auth",
      "env": "MELKER_OAUTH_PATH",
      "description": "OAuth callback path"
    },
    "oauth.redirectUri": {
      "type": "string",
      "env": "MELKER_OAUTH_REDIRECT_URI",
      "description": "OAuth redirect URI"
    },
    "oauth.scopes": {
      "type": "string",
      "default": "openid profile offline_access",
      "env": "MELKER_OAUTH_SCOPES",
      "description": "OAuth scopes (space-separated)"
    },
    "oauth.audience": {
      "type": "string",
      "env": "MELKER_OAUTH_AUDIENCE",
      "description": "OAuth audience parameter"
    },
    "oauth.wellknownUrl": {
      "type": "string",
      "env": "MELKER_OAUTH_WELLKNOWN_URL",
      "description": "OAuth well-known configuration URL"
    },
    "stdout.enabled": {
      "type": "boolean",
      "default": false,
      "flag": "--stdout",
      "description": "Output buffer to stdout after timeout (no terminal control)"
    },
    "stdout.interactive": {
      "type": "boolean",
      "default": false,
      "flag": "--interactive",
      "description": "Force interactive TUI mode even when stdout is not a TTY"
    },
    "stdout.timeout": {
      "type": "integer",
      "default": 200,
      "minimum": 0,
      "maximum": 60000,
      "env": "MELKER_STDOUT_TIMEOUT",
      "flag": "--stdout-timeout",
      "description": "Milliseconds to wait before printing buffer (default: 500)"
    },
    "stdout.width": {
      "type": "integer",
      "minimum": 1,
      "maximum": 1000,
      "env": "MELKER_STDOUT_WIDTH",
      "flag": "--stdout-width",
      "description": "Output width in columns (default: terminal width)"
    },
    "stdout.height": {
      "type": "integer",
      "minimum": 1,
      "maximum": 1000,
      "env": "MELKER_STDOUT_HEIGHT",
      "flag": "--stdout-height",
      "description": "Output height in rows (default: terminal height)"
    },
    "stdout.color": {
      "type": "string",
      "enum": ["auto", "always", "never"],
      "default": "auto",
      "env": "MELKER_STDOUT_COLOR",
      "flag": "--color",
      "description": "ANSI color output: auto (strip when piped), always (force colors), never (no colors)"
    },
    "stdout.trim": {
      "type": "string",
      "enum": ["none", "right", "bottom", "both"],
      "default": "none",
      "env": "MELKER_STDOUT_TRIM",
      "flag": "--stdout-trim",
      "description": "Trim stdout output: none (default), right (trailing spaces), bottom (trailing newlines), both"
    },
    "allow.read": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--allow-read",
      "description": "Additional read paths to allow"
    },
    "allow.write": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--allow-write",
      "description": "Additional write paths to allow"
    },
    "allow.net": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--allow-net",
      "description": "Additional network hosts to allow"
    },
    "allow.run": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--allow-run",
      "description": "Additional commands to allow"
    },
    "allow.env": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--allow-env",
      "description": "Additional environment variables to allow"
    },
    "allow.ffi": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--allow-ffi",
      "description": "Additional FFI libraries to allow"
    },
    "allow.sys": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--allow-sys",
      "description": "Additional system info to allow"
    },
    "allow.all": {
      "type": "boolean",
      "flag": "--allow-all",
      "description": "Allow all permissions"
    },
    "allow.ai": {
      "type": "boolean",
      "flag": "--allow-ai",
      "description": "Allow AI tools (ffmpeg, openrouter.ai)"
    },
    "allow.clipboard": {
      "type": "boolean",
      "flag": "--allow-clipboard",
      "description": "Allow clipboard access"
    },
    "allow.keyring": {
      "type": "boolean",
      "flag": "--allow-keyring",
      "description": "Allow keyring access"
    },
    "allow.browser": {
      "type": "boolean",
      "flag": "--allow-browser",
      "description": "Allow opening browser"
    },
    "allow.shader": {
      "type": "boolean",
      "flag": "--allow-shader",
      "description": "Allow shader execution"
    },
    "deny.read": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--deny-read",
      "description": "Read paths to deny"
    },
    "deny.write": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--deny-write",
      "description": "Write paths to deny"
    },
    "deny.net": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--deny-net",
      "description": "Network hosts to deny"
    },
    "deny.run": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--deny-run",
      "description": "Commands to deny"
    },
    "deny.env": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--deny-env",
      "description": "Environment variables to deny"
    },
    "deny.ffi": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--deny-ffi",
      "description": "FFI libraries to deny"
    },
    "deny.sys": {
      "type": "array",
      "items": { "type": "string" },
      "flag": "--deny-sys",
      "description": "System info to deny"
    },
    "deny.all": {
      "type": "boolean",
      "flag": "--deny-all",
      "description": "Deny all permissions"
    },
    "deny.ai": {
      "type": "boolean",
      "flag": "--deny-ai",
      "description": "Deny AI tools"
    },
    "deny.clipboard": {
      "type": "boolean",
      "flag": "--deny-clipboard",
      "description": "Deny clipboard access"
    },
    "deny.keyring": {
      "type": "boolean",
      "flag": "--deny-keyring",
      "description": "Deny keyring access"
    },
    "deny.browser": {
      "type": "boolean",
      "flag": "--deny-browser",
      "description": "Deny opening browser"
    },
    "deny.shader": {
      "type": "boolean",
      "flag": "--deny-shader",
      "description": "Deny shader execution"
    },
    "toast.maxVisible": {
      "type": "integer",
      "default": 5,
      "minimum": 1,
      "maximum": 20,
      "env": "MELKER_TOAST_MAX_VISIBLE",
      "description": "Maximum visible toasts before dismissing oldest"
    },
    "toast.position": {
      "type": "string",
      "enum": ["bottom", "top"],
      "default": "bottom",
      "env": "MELKER_TOAST_POSITION",
      "description": "Toast container position"
    },
    "toast.defaultDuration": {
      "type": "integer",
      "default": 5000,
      "minimum": 1000,
      "maximum": 60000,
      "env": "MELKER_TOAST_DURATION",
      "description": "Default toast duration in ms"
    },
    "toast.inactivityTimeout": {
      "type": "integer",
      "default": 8000,
      "minimum": 1000,
      "maximum": 60000,
      "env": "MELKER_TOAST_INACTIVITY",
      "description": "Dismiss all toasts after inactivity (ms)"
    },
    "toast.bell": {
      "type": "boolean",
      "default": false,
      "env": "MELKER_TOAST_BELL",
      "description": "Play terminal bell on error toasts"
    },
    "toast.width": {
      "type": "integer",
      "default": 40,
      "minimum": 20,
      "maximum": 120,
      "env": "MELKER_TOAST_WIDTH",
      "description": "Toast container width in characters"
    }
  }
}
